XVEMSYN1 ;V4W/DLW - Syntax highlighting ;2019-06-19  11:02 AM
 ;;15.2;VICTORY PROG ENVIRONMENT;;Aug 27, 2019
 ; (c) David Wicksell 2019
 ;
CONTROL ;Return proper ANSI VT-100 escape sequences for colors and cursor movement
 ; ZEXCEPT: CODE,ROW,COL
 N MOV,OFF,DEF,CMD,ARG,TAG,FUNC,COM,PUNC,NUM,STR,ERR,BLACK,RED,GREEN,YELLOW,BLUE,MAGENTA,CYAN,WHITE
 S ROW=$G(ROW),COL=$G(COL)
 I COL'="",ROW="" S ROW=1
 I ROW'="",COL="" S COL=1
 S MOV=$C(27)_"["_ROW_";"_COL_"H"
 S DEF=$C(27)_"[0m",OFF=""
 S BLACK=$C(27)_"[30m"_$C(27)_"[40m"
 S RED=$C(27)_"[31m"_$C(27)_"[41m"
 S GREEN=$C(27)_"[32m"_$C(27)_"[42m"
 S YELLOW=$C(27)_"[33m"_$C(27)_"[43m"
 S BLUE=$C(27)_"[34m"_$C(27)_"[44m"
 S MAGENTA=$C(27)_"[35m"_$C(27)_"[45m"
 S CYAN=$C(27)_"[36m"_$C(27)_"[46m"
 S WHITE=$C(27)_"[37m"_$C(27)_"[47m"
 S CMD=$E(@($$ALLCAPS^XVEMKU($G(^XVEMS("PARAM",XVV("ID"),"SYNTAX","COMMAND","FG"),"Yellow"))),1,5)
 S CMD=CMD_$E(@($$ALLCAPS^XVEMKU($G(^XVEMS("PARAM",XVV("ID"),"SYNTAX","COMMAND","BG"),"Off"))),6,10)
 S ARG=$E(@($$ALLCAPS^XVEMKU($G(^XVEMS("PARAM",XVV("ID"),"SYNTAX","ARGUMENT","FG"),"Magenta"))),1,5)
 S ARG=ARG_$E(@($$ALLCAPS^XVEMKU($G(^XVEMS("PARAM",XVV("ID"),"SYNTAX","ARGUMENT","BG"),"Off"))),6,10)
 S TAG=$E(@($$ALLCAPS^XVEMKU($G(^XVEMS("PARAM",XVV("ID"),"SYNTAX","TAG","FG"),"Magenta"))),1,5)
 S TAG=TAG_$E(@($$ALLCAPS^XVEMKU($G(^XVEMS("PARAM",XVV("ID"),"SYNTAX","TAG","BG"),"Off"))),6,10)
 S FUNC=$E(@($$ALLCAPS^XVEMKU($G(^XVEMS("PARAM",XVV("ID"),"SYNTAX","FUNCTION","FG"),"Cyan"))),1,5)
 S FUNC=FUNC_$E(@($$ALLCAPS^XVEMKU($G(^XVEMS("PARAM",XVV("ID"),"SYNTAX","FUNCTION","BG"),"Off"))),6,10)
 S COM=$E(@($$ALLCAPS^XVEMKU($G(^XVEMS("PARAM",XVV("ID"),"SYNTAX","COMMENT","FG"),"Blue"))),1,5)
 S COM=COM_$E(@($$ALLCAPS^XVEMKU($G(^XVEMS("PARAM",XVV("ID"),"SYNTAX","COMMENT","BG"),"Off"))),6,10)
 S PUNC=$E(@($$ALLCAPS^XVEMKU($G(^XVEMS("PARAM",XVV("ID"),"SYNTAX","PUNCTUATION","FG"),"Green"))),1,5)
 S PUNC=PUNC_$E(@($$ALLCAPS^XVEMKU($G(^XVEMS("PARAM",XVV("ID"),"SYNTAX","PUNCTUATION","BG"),"Off"))),6,10)
 S NUM=$E(@($$ALLCAPS^XVEMKU($G(^XVEMS("PARAM",XVV("ID"),"SYNTAX","NUMBER","FG"),"Red"))),1,5)
 S NUM=NUM_$E(@($$ALLCAPS^XVEMKU($G(^XVEMS("PARAM",XVV("ID"),"SYNTAX","NUMBER","BG"),"Off"))),6,10)
 S STR=$E(@($$ALLCAPS^XVEMKU($G(^XVEMS("PARAM",XVV("ID"),"SYNTAX","STRING","FG"),"Red"))),1,5)
 S STR=STR_$E(@($$ALLCAPS^XVEMKU($G(^XVEMS("PARAM",XVV("ID"),"SYNTAX","STRING","BG"),"Off"))),6,10)
 S ERR=$E(@($$ALLCAPS^XVEMKU($G(^XVEMS("PARAM",XVV("ID"),"SYNTAX","ERRROR","FG"),"White"))),1,5)
 S ERR=ERR_$E(@($$ALLCAPS^XVEMKU($G(^XVEMS("PARAM",XVV("ID"),"SYNTAX","ERROR","BG"),"Red"))),6,10)
 S CODE=$$ALLCAPS^XVEMKU(CODE)
 W DEF
 I CODE["/" Q $S($P(CODE,"/",1)="OFF":"",1:$E(@$P(CODE,"/",1),1,5))_$S($P(CODE,"/",2)'="":$E(@$P(CODE,"/",2),6,10),1:"")
 E  Q @CODE
